{"ast":null,"code":"var _jsxFileName = \"D:\\\\xampp\\\\htdocs\\\\digital-form-oms-TCC\\\\react\\\\src\\\\pages\\\\Prontuario\\\\index.js\";\nimport React, { useState } from 'react';\nimport { useLocation } from \"react-router-dom\";\nimport './styles.css';\nimport { useHistory } from \"react-router-dom\";\nimport { TextField, Button, CircularProgress } from '@material-ui/core';\nimport { Add, Edit } from '@material-ui/icons';\nimport { connect } from 'react-redux';\nimport api from '../../services/api';\n\nfunction setParticipantId(participantId) {\n  return {\n    type: 'STORE_PARTICIPANT_ID',\n    participantId: participantId\n  };\n}\n\nfunction Prontuario({\n  user,\n  dispatch\n}) {\n  const [search, setSearch] = useState('');\n  const [error, setError] = useState('');\n  const [modules, setModules] = useState([]);\n  const [modulesLoaded, setModulesLoaded] = useState(false);\n  const [loadingSearch, setLoadingSearch] = useState(false);\n  const history = useHistory();\n  const location = useLocation();\n\n  async function handleSearch(e) {\n    e.preventDefault();\n    setError('');\n    setLoadingSearch(true);\n    setModulesLoaded(false);\n    const response = await api.post('/searchMedicalRecord', {\n      medicalRecord: search,\n      hospitalUnitId: user[location.state.hospitalIndex].hospitalunitid\n    }).catch(function (error) {\n      setLoadingSearch(false);\n      console.log(error);\n      console.log(error.response.data);\n    });\n\n    if (response.data) {\n      setLoadingSearch(false);\n      setModulesLoaded(true);\n\n      if (response.data.length > 0) {\n        dispatch(setParticipantId(response.data[0].participantID));\n\n        if (response.data[0].msgRetorno) {\n          setError(response.data[0].msgRetorno);\n        } else {\n          setError('');\n        }\n      }\n\n      for (let record of response.data) {\n        record.dataRefer = new Date(record.dataRefer);\n        record.dtRegistroSystem = new Date(record.dtRegistroSystem);\n\n        switch (record.crfformsid) {\n          case 1:\n            record['moduleName'] = 'Admissão';\n            break;\n\n          case 2:\n            record['moduleName'] = 'Acompanhamento';\n            break;\n\n          case 3:\n            record['moduleName'] = 'Alta ou Morte';\n            break;\n        }\n      }\n    }\n\n    setModules(response.data);\n    console.log(response.data);\n  }\n\n  function toForm(prontuario) {\n    console.log('prontuário escolhido: ', prontuario);\n    history.push('/modulos');\n  }\n\n  function handleChange(e) {\n    const target = e.target;\n    const value = target.value;\n    console.log(value);\n    setSearch(value);\n  }\n\n  return /*#__PURE__*/React.createElement(\"main\", {\n    className: \"container prontuarios\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"header\", {\n    className: \"index\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"b\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 21\n    }\n  }, location.state.hospitalName)), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 17\n    }\n  }, \"Prontu\\xE1rio\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"prontuario-options\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    noValidate: true,\n    autoComplete: \"off\",\n    onSubmit: handleSearch,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    id: \"standard-basic\",\n    label: \"N\\xBA Prontu\\xE1rio\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 21\n    }\n  }, !loadingSearch && 'Buscar', loadingSearch && /*#__PURE__*/React.createElement(CircularProgress, {\n    color: \"white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 29\n    }\n  }))), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outlined\",\n    color: \"primary\",\n    className: \"add-prontuario\",\n    onClick: () => {\n      history.push('/add-prontuario', {\n        hospitalIndex: location.state.hospitalIndex\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Add, {\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 21\n    }\n  }), \"Novo Prontu\\xE1rio\")), error && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 17\n    }\n  }, error), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"prontuario-result\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 13\n    }\n  }, modulesLoaded && !error && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"title-table\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 25\n    }\n  }, \"M\\xF3dulos cadastrados do prontu\\xE1rio \", modules.length > 0 ? modules[0].medicalRecord : search, /*#__PURE__*/React.createElement(Edit, {\n    onClick: () => {\n      history.push('/editar-prontuario', {\n        hospitalIndex: location.state.hospitalIndex,\n        prontuario: modules.length > 0 ? modules[0].medicalRecord : search,\n        participantId: modules[0].participantID\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 25\n    }\n  })), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outlined\",\n    color: \"primary\",\n    className: \"add-modulo\",\n    onClick: () => {\n      history.push('/modulos', {\n        hospitalIndex: location.state.hospitalIndex,\n        prontuario: modules.length > 0 ? modules[0].medicalRecord : search,\n        registeredModules: modules[0].formrecordid ? modules : []\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Add, {\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 29\n    }\n  }), \"Novo lan\\xE7amento de m\\xF3dulo\")), modules.length > 0 && modulesLoaded && !error && modules[0].formrecordid && /*#__PURE__*/React.createElement(\"table\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 33\n    }\n  }, \"Formul\\xE1rio\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 33\n    }\n  }, \"Data\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 33\n    }\n  }, \"Quest\\xF5es respondidas(%)\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 25\n    }\n  }, modules.map((module, index) => /*#__PURE__*/React.createElement(\"tr\", {\n    key: module.formrecordid,\n    className: \"data-items\",\n    onClick: () => {\n      history.push('/formulario', {\n        modulo: module.crfformsid,\n        formRecordId: module.formrecordid,\n        hospitalIndex: location.state.hospitalIndex,\n        registeredModules: modules[0].formrecordid ? modules : []\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 37\n    }\n  }, module.moduleName), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 37\n    }\n  }, module.dataRefer.getDate() + 1, \"/\", module.dataRefer.getMonth() + 1, \"/\", module.dataRefer.getFullYear()), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 37\n    }\n  }, Math.ceil(module.questionAnswerTot * 100 / module.questionTot), \"%\")))))));\n}\n\nexport default connect(state => ({\n  user: state.user\n}))(Prontuario);","map":{"version":3,"sources":["D:/xampp/htdocs/digital-form-oms-TCC/react/src/pages/Prontuario/index.js"],"names":["React","useState","useLocation","useHistory","TextField","Button","CircularProgress","Add","Edit","connect","api","setParticipantId","participantId","type","Prontuario","user","dispatch","search","setSearch","error","setError","modules","setModules","modulesLoaded","setModulesLoaded","loadingSearch","setLoadingSearch","history","location","handleSearch","e","preventDefault","response","post","medicalRecord","hospitalUnitId","state","hospitalIndex","hospitalunitid","catch","console","log","data","length","participantID","msgRetorno","record","dataRefer","Date","dtRegistroSystem","crfformsid","toForm","prontuario","push","handleChange","target","value","hospitalName","registeredModules","formrecordid","map","module","index","modulo","formRecordId","moduleName","getDate","getMonth","getFullYear","Math","ceil","questionAnswerTot","questionTot"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport { useLocation } from \"react-router-dom\";\r\nimport './styles.css';\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { TextField, Button, CircularProgress } from '@material-ui/core';\r\nimport { Add, Edit } from '@material-ui/icons';\r\n\r\nimport { connect } from 'react-redux';\r\n\r\nimport api from '../../services/api';\r\n\r\nfunction setParticipantId(participantId) {\r\n    return {\r\n      type: 'STORE_PARTICIPANT_ID',\r\n      participantId: participantId\r\n    }\r\n  }\r\n\r\nfunction Prontuario({user, dispatch}) {\r\n\r\n    const [search, setSearch] = useState('');\r\n    const [error, setError] = useState('');\r\n    const [modules, setModules] = useState([]);\r\n    const [modulesLoaded, setModulesLoaded] = useState(false);\r\n    const [loadingSearch, setLoadingSearch] = useState(false);\r\n\r\n    const history = useHistory();\r\n\r\n    const location = useLocation();\r\n\r\n    async function handleSearch(e) {\r\n        e.preventDefault();\r\n        setError('');\r\n        setLoadingSearch(true);\r\n        setModulesLoaded(false);\r\n        const response = await api.post('/searchMedicalRecord', {\r\n            medicalRecord: search,\r\n            hospitalUnitId: user[location.state.hospitalIndex].hospitalunitid,\r\n        }).catch( function (error) {\r\n            setLoadingSearch(false);\r\n            console.log(error)\r\n            console.log(error.response.data)\r\n        });\r\n       \r\n        if(response.data) {\r\n            setLoadingSearch(false);\r\n            setModulesLoaded(true);\r\n            if(response.data.length > 0) {\r\n                dispatch(setParticipantId(response.data[0].participantID));\r\n                if(response.data[0].msgRetorno) {\r\n                    setError(response.data[0].msgRetorno)\r\n                } else {\r\n                    setError('')\r\n                }\r\n            }\r\n\r\n            for(let record of response.data) {\r\n                record.dataRefer = new Date(record.dataRefer);\r\n                record.dtRegistroSystem = new Date(record.dtRegistroSystem);\r\n                switch (record.crfformsid) {\r\n                    case 1:\r\n                        record['moduleName'] = 'Admissão'\r\n                        break;\r\n                    case 2:\r\n                        record['moduleName'] = 'Acompanhamento'\r\n                        break;\r\n                    case 3:\r\n                        record['moduleName'] = 'Alta ou Morte'\r\n                        break;\r\n                    \r\n                  }\r\n            }\r\n        }\r\n\r\n        setModules(response.data)\r\n        console.log(response.data);\r\n    }\r\n\r\n    function toForm(prontuario) {\r\n        console.log('prontuário escolhido: ', prontuario);\r\n        history.push('/modulos');\r\n    }\r\n\r\n    function handleChange(e) {\r\n        const target = e.target;\r\n        const value = target.value;\r\n        console.log(value);\r\n        setSearch(value);\r\n    }\r\n\r\n\r\n    return (\r\n        <main className=\"container prontuarios\">\r\n            <div>\r\n                <header className=\"index\">\r\n                    <b>{location.state.hospitalName}</b>\r\n                </header>\r\n                <h2>Prontuário</h2>\r\n            </div>\r\n            <div className=\"prontuario-options\">\r\n                <form noValidate autoComplete=\"off\" onSubmit={handleSearch}>\r\n                    <TextField id=\"standard-basic\" label=\"Nº Prontuário\" onChange={handleChange}/>\r\n                    <Button variant=\"contained\" color=\"primary\" type=\"submit\">\r\n                        { !loadingSearch &&\r\n                            'Buscar'\r\n                        }\r\n                        { loadingSearch &&\r\n                            <CircularProgress color=\"white\"/>\r\n                        }\r\n                    </Button>\r\n                </form>\r\n                <Button variant=\"outlined\" color=\"primary\" className=\"add-prontuario\" onClick={ () => {\r\n                    history.push('/add-prontuario', { hospitalIndex: location.state.hospitalIndex })\r\n                }}>\r\n                    <Add color=\"primary\" />\r\n                    Novo Prontuário\r\n                </Button>\r\n            </div>\r\n            { (error) &&\r\n                <span className=\"error\">{ error }</span>\r\n            }\r\n            <div className=\"prontuario-result\">\r\n                { modulesLoaded && !error &&\r\n                    <div className=\"title-table\">\r\n                        <h4>Módulos cadastrados do prontuário { modules.length > 0 ? modules[0].medicalRecord : search }\r\n                        <Edit onClick={ () => {\r\n                            history.push('/editar-prontuario', { hospitalIndex: location.state.hospitalIndex,\r\n                                                                 prontuario: modules.length > 0 ? modules[0].medicalRecord : search,\r\n                                                                 participantId: modules[0].participantID })\r\n                        }}/>\r\n                        </h4>\r\n                        <Button variant=\"outlined\" color=\"primary\" className=\"add-modulo\" onClick={ () => {\r\n                            history.push('/modulos', { hospitalIndex: location.state.hospitalIndex,\r\n                                                       prontuario: modules.length > 0 ? modules[0].medicalRecord : search,\r\n                                                       registeredModules: modules[0].formrecordid ? modules : [] })\r\n                        }}>\r\n                            <Add color=\"primary\" />\r\n                            Novo lançamento de módulo\r\n                        </Button>\r\n                    </div>\r\n                }\r\n                { modules.length > 0 && modulesLoaded && !error && modules[0].formrecordid &&\r\n                    <table>\r\n                        <thead>\r\n                            <tr>\r\n                                <th>Formulário</th>\r\n                                <th>Data</th> \r\n                                <th>Questões respondidas(%)</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {modules.map((module, index) => (\r\n                                <tr key={module.formrecordid} className=\"data-items\" onClick={ () => {\r\n                                    history.push('/formulario', { modulo: module.crfformsid,\r\n                                                                  formRecordId: module.formrecordid,\r\n                                                                  hospitalIndex: location.state.hospitalIndex,\r\n                                                                  registeredModules: modules[0].formrecordid ? modules : [] })\r\n                                }}>\r\n                                    <td>{ module.moduleName }</td>\r\n                                    <td>{ module.dataRefer.getDate() + 1 }/{ module.dataRefer.getMonth() + 1 }/{ module.dataRefer.getFullYear() }</td>\r\n                                    <td>{ Math.ceil(module.questionAnswerTot * 100 / module.questionTot) }%</td>\r\n                                </tr>\r\n                                \r\n                            ))}\r\n                        </tbody>\r\n                    </table>\r\n                }\r\n            </div>\r\n            \r\n        </main>\r\n    );\r\n}\r\n\r\nexport default connect(state => ({ user: state.user }))(Prontuario);"]},"metadata":{},"sourceType":"module"}